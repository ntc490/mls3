<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}MLS3{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <nav>
            <h1>MLS3</h1>
            <ul>
                <li><a href="{{ url_for('index') }}">Home</a></li>
                <li><a href="{{ url_for('prayer_scheduler') }}">Prayer Scheduler</a></li>
                <li><a href="{{ url_for('appointment_scheduler') }}">Appointments</a></li>
                <li><a href="{{ url_for('events') }}">Events</a></li>
                <li><a href="{{ url_for('members_list') }}">Members</a></li>
            </ul>
        </nav>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Member Info Modal -->
    <div id="memberInfoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalMemberName">Member Info</h2>
                <button class="close-btn" onclick="closeMemberModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="member-info-section">
                    <div class="info-row">
                        <span class="info-label">Age:</span>
                        <span id="modalAge"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Gender:</span>
                        <span id="modalGender"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Birthday:</span>
                        <span id="modalBirthday"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Phone:</span>
                        <span id="modalPhone"></span>
                    </div>
                    <div class="info-row info-row-clickable" id="modalAkaRow" onclick="openAkaDialog()">
                        <span class="info-label">AKA:</span>
                        <span id="modalAka" class="aka-value">Not set</span>
                    </div>
                    <div class="info-row info-row-clickable" onclick="openSkipDialog()">
                        <span class="info-label">Skip Until:</span>
                        <span id="modalSkipUntil" class="skip-until-value">Not set</span>
                    </div>
                    <div class="info-row" id="modalNotesRow" style="display: none;">
                        <span class="info-label">Notes:</span>
                        <span id="modalNotes"></span>
                    </div>
                </div>

                <div class="member-actions-section">
                    <button id="sendTextBtn" class="btn btn-secondary">SMS+</button>
                    <button id="apptBtn" class="btn btn-primary">Appt</button>
                    <button id="prayBtn" class="btn btn-primary">Pray</button>
                </div>

                <div class="member-toggles-section">
                    <div class="toggle-row">
                        <span class="toggle-label">Active Member</span>
                        <label class="switch">
                            <input type="checkbox" id="toggleActive">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="toggle-label">Don't Ask for Prayers</span>
                        <label class="switch">
                            <input type="checkbox" id="toggleDontAsk">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="member-flag-section">
                    <div class="flag-selector">
                        <button class="flag-selector-btn" data-flag="blue" onclick="setMemberFlag('blue')">
                            <span class="flag-selector-circle flag-blue"></span>
                        </button>
                        <button class="flag-selector-btn" data-flag="yellow" onclick="setMemberFlag('yellow')">
                            <span class="flag-selector-circle flag-yellow"></span>
                        </button>
                        <button class="flag-selector-btn" data-flag="red" onclick="setMemberFlag('red')">
                            <span class="flag-selector-circle flag-red"></span>
                        </button>
                    </div>
                </div>

                <div class="prayer-history-section">
                    <h3>Prayer History</h3>
                    <div id="prayerHistoryList" class="prayer-history-list">
                        <p class="text-muted">Loading...</p>
                    </div>
                </div>

                <div class="event-history-section">
                    <h3>History</h3>
                    <div id="eventHistoryList" class="event-history-list">
                        <p class="text-muted">Loading...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AKA Dialog Modal -->
    <div id="akaDialogModal" class="modal">
        <div class="modal-content skip-dialog-content">
            <div class="modal-header">
                <h2>Also Known As (AKA)</h2>
                <button class="close-btn" onclick="closeAkaDialog()">&times;</button>
            </div>
            <div class="modal-body">
                <p class="help-text">Set a preferred name for this member (e.g., "Mike" instead of "Michael")</p>
                <div class="aka-input-section">
                    <label for="akaInput">Preferred Name:</label>
                    <input type="text" id="akaInput" class="text-input" placeholder="Enter preferred name">
                    <button class="btn btn-sm btn-secondary" onclick="setAka()">Set AKA</button>
                </div>
                <div class="skip-dialog-actions">
                    <button class="btn btn-secondary" onclick="clearAka()">Clear AKA</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Skip Dialog Modal -->
    <div id="skipDialogModal" class="modal">
        <div class="modal-content skip-dialog-content">
            <div class="modal-header">
                <h2>Skip Until</h2>
                <button class="close-btn" onclick="closeSkipDialog()">&times;</button>
            </div>
            <div class="modal-body">
                <p class="help-text">Temporarily remove this member from prayer rotation</p>
                <div class="skip-quick-buttons">
                    <button class="btn btn-sm btn-secondary" onclick="setSkipUntilFromDialog(1)">1 Month</button>
                    <button class="btn btn-sm btn-secondary" onclick="setSkipUntilFromDialog(3)">3 Months</button>
                    <button class="btn btn-sm btn-secondary" onclick="setSkipUntilFromDialog(6)">6 Months</button>
                </div>
                <div class="skip-date-picker">
                    <label for="skipDatePicker">Or choose a custom date:</label>
                    <input type="date" id="skipDatePicker" class="date-input">
                    <button class="btn btn-sm btn-secondary" onclick="setCustomSkipDate()">Set Date</button>
                </div>
                <div class="skip-dialog-actions">
                    <button class="btn btn-secondary" onclick="clearSkipFromDialog()">Clear Skip</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>MLS3 - Member Leadership Scheduling System</p>
    </footer>

    <script src="{{ url_for('static', filename='js/member_modal.js') }}"></script>
    {% block scripts %}{% endblock %}
</body>
</html>
